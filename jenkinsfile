

pipeline
{

agent { label 'node1' 
   }

parameters{
      string(name: 'IMAGE', defaultValue: 'myimage', description: 'docker image name')
}
  stages {
 
       stage ('git checkout') {
	   
	      steps {
		  
		   git branch: 'develop', url: 'https://github.com/mrudulapolavaram/devopstrainrepo.git'
		   
		   }
		}
		   
		   
		stage ('Initialize') {
            steps {
                    echo "PATH = ${PATH}"
                    echo "M2_HOME = ${M2_HOME}"
                 
          }
		 
	    
	} 
	stage ('Build') {
            steps {
           				    sh 'mvn clean compile'
			}
            }
	stage ('testing') {
            steps {
           				    sh 'mvn test'
			}
			}
	stage ('install') {
            steps {
           				    sh 'mvn install'
			}
            }	
            
     		
    stage ("Build image") {
	       steps{		     
        // download the dockerfile to build from
                // build our docker image
           sh'''
	       cd ${WORKSPACE}
		   echo ${WORKSPACE}
		   echo ${IMAGE}
           docker build . -t ${IMAGE}:${BUILD_NUMBER}
	       '''
		   }
	}
	}
}  
